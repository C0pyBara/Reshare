import re

# –ù–∞–±–æ—Ä—ã –∫–ª—é—á–µ–π —Å –≤–µ—Å–∞–º–∏
KEYWORDS_WEIGHTS = {
    # –¢—è–∂–µ–ª—ã–µ (–°–∫–∞–º, –ö—Ä–∏–ø—Ç–∞, –ö–∞–∑–∏–Ω–æ)
    "heavy": {
        "words": ["p2p", "–∞—Ä–±–∏—Ç—Ä–∞–∂", "–ø—Ä–æ—Ñ–∏—Ç", "–∏–∫—Å—ã", "–∞–∏—Ä–¥—Ä–æ–ø", "–ª–∏—Å—Ç–∏–Ω–≥", "–∫–∞–∑–∏–Ω–æ", "—Å—Ç–∞–≤–∫–∏", "–≤—ã–∏–≥—Ä—ã—à", "—Å–ª–æ—Ç—ã"],
        "weight": 5
    },
    # –†–µ–∫–ª–∞–º–Ω—ã–µ (–ü—Ä–æ–¥–∞–∂–∏, –ö—É—Ä—Å—ã)
    "ad": {
        "words": ["–≤–µ–±–∏–Ω–∞—Ä", "–∏–Ω—Ç–µ–Ω—Å–∏–≤", "–º–∞—Ä–∞—Ñ–æ–Ω", "—á–µ–∫-–ª–∏—Å—Ç", "—Å–∫–∏–¥–∫–∞", "–∞–∫—Ü–∏—è", "–∫—É–ø–∏—Ç—å", "–∑–∞–∫–∞–∑–∞—Ç—å", "–ø—Ä–∞–π—Å"],
        "weight": 3
    },
    # –ü—Ä–∏–∑—ã–≤—ã (CTA - Call to Action) - –±–∞–∑–æ–≤—ã–µ
    "cta": {
        "words": ["–ø–æ–¥–ø–∏—à–∏—Å—å", "–∑–∞–∫—Ä–µ–ø–µ", "–ø–µ—Ä–µ—Ö–æ–¥–∏", "–∑–∞–±–∏—Ä–∞–π", "–∂–º–∏", "—Å—Å—ã–ª–∫–∞", "–≤—Ö–æ–¥", "—á–∏—Ç–∞—Ç—å –¥–∞–ª–µ–µ"],
        "weight": 4
    },
    # –ú—è–≥–∫–∏–µ –ø—Ä–∏–∑—ã–≤—ã –∫ –¥–µ–π—Å—Ç–≤–∏—é (–Ω–µ—è–≤–Ω—ã–µ CTA)
    "soft_cta": {
        "words": [
            "—É–∑–Ω–∞—Ç—å –ø–æ–¥—Ä–æ–±–Ω–µ–µ", "–ø–æ–ª—É—á–∏—Ç—å –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—é", "–∑–∞–ø–∏—Å–∞—Ç—å—Å—è",
            "–∑–∞–ø–æ–ª–Ω–∏—Ç—å —Ñ–æ—Ä–º—É", "–æ—Å—Ç–∞–≤–∏—Ç—å –∑–∞—è–≤–∫—É", "–æ—Å—Ç–∞–≤–∏—Ç—å –∫–æ–Ω—Ç–∞–∫—Ç—ã",
            "—Å–∫–∞—á–∞—Ç—å —Ñ–∞–π–ª", "–ø–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø", "–æ—Ç–∫—Ä—ã—Ç—å –¥–æ—Å—Ç—É–ø",
            "–ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ø—Ä–∏–º–µ—Ä", "–ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –æ–±–∑–æ—Ä", "—Å–º–æ—Ç—Ä–µ—Ç—å –≤–∏–¥–µ–æ",
            "–∑–∞–±—Ä–æ–Ω–∏—Ä–æ–≤–∞—Ç—å", "–∑–∞—Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞—Ç—å", "–∑–∞–±—Ä–∞—Ç—å —Å–æ —Å–∫–ª–∞–¥–∞"
        ],
        "weight": 4
    },
    # –°–æ—Ü–∏–∞–ª—å–Ω—ã–µ –¥–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–∞
    "social_proof": {
        "words": [
            "—É–∂–µ –∫—É–ø–∏–ª–∏", "—É–∂–µ –∑–∞–∫–∞–∑–∞–ª–∏", "—É–∂–µ –ø–æ–ø—Ä–æ–±–æ–≤–∞–ª–∏",
            "–±–æ–ª–µ–µ 1000 –∑–∞–∫–∞–∑–æ–≤", "500+ –¥–æ–≤–æ–ª—å–Ω—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤",
            "–æ—Ç–∑—ã–≤—ã –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π", "—Ä–µ–∞–ª—å–Ω—ã–µ –æ—Ç–∑—ã–≤—ã", "—Ñ–æ—Ç–æ–æ—Ç—á–µ—Ç—ã",
            "—Ä–µ–∫–æ–º–µ–Ω–¥—É—é—Ç", "—Å–æ–≤–µ—Ç—É—é—Ç", "–≤—ã–±–∏—Ä–∞—é—Ç",
            "—Ç–æ–ø-10", "–≤—Ö–æ–¥–∏—Ç –≤ —Ç–æ–ø", "–ª–∏–¥–µ—Ä –ø—Ä–æ–¥–∞–∂"
        ],
        "weight": 3
    },
    # –ü—Å–∏—Ö–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–µ —Ç—Ä–∏–≥–≥–µ—Ä—ã
    "psychological": {
        "words": [
            "–Ω–µ —É–ø—É—Å—Ç–∏", "—ç—Ç–æ —Ç–≤–æ–π —à–∞–Ω—Å", "–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∏–∑–º–µ–Ω–∏—Ç—å",
            "–º–µ—á—Ç–∞–µ—à—å", "—Ö–æ—á–µ—à—å", "–∂–µ–ª–∞–µ—à—å", "—Å—Ç—Ä–µ–º–∏—à—å—Å—è",
            "–¥–ª—è —É–º–Ω—ã—Ö", "–¥–ª—è —É—Å–ø–µ—à–Ω—ã—Ö", "–¥–ª—è —Ü–µ–ª–µ—É—Å—Ç—Ä–µ–º–ª–µ–Ω–Ω—ã—Ö",
            "—Å–µ–∫—Ä–µ—Ç", "—Ç–∞–π–Ω–∞", "–º–µ—Ç–æ–¥", "—Å–∏—Å—Ç–µ–º–∞", "—Å—Ç—Ä–∞—Ç–µ–≥–∏—è"
        ],
        "weight": 4
    },
    # –ù–µ–π–º–∏–Ω–≥ –∏ –±—Ä–µ–Ω–¥–∏–Ω–≥
    "branding": {
        "words": [
            "–ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç", "–∑–∞–ø—É—Å–∫–∞–µ—Ç",
            "–∫–æ–º–ø–∞–Ω–∏—è", "—Å—Ç—É–¥–∏—è", "–º–∞–≥–∞–∑–∏–Ω",
            "–ø—Ä–æ–¥—É–∫—Ç", "–∫—É—Ä—Å", "—Ç—Ä–µ–Ω–∏–Ω–≥",
            "–∞–≤—Ç–æ—Ä—Å–∫–∏–π", "—Ñ–∏—Ä–º–µ–Ω–Ω—ã–π", "–æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π", "–ª–∏—Ü–µ–Ω–∑–∏–æ–Ω–Ω—ã–π"
        ],
        "weight": 3
    },
    # –û–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –∏ –∫—É—Ä—Å—ã
    "education": {
        "words": [
            "–∫—É—Ä—Å", "–æ–±—É—á–µ–Ω–∏–µ", "–≤–µ–±–∏–Ω–∞—Ä", "–º–∞—Å—Ç–µ—Ä-–∫–ª–∞—Å—Å", "–∏–Ω—Ç–µ–Ω—Å–∏–≤",
            "–º–æ–¥—É–ª—å", "—É—Ä–æ–∫", "–ª–µ–∫—Ü–∏—è", "—Å–µ–º–∏–Ω–∞—Ä", "–ø—Ä–∞–∫—Ç–∏–∫—É–º",
            "–¥–∏–ø–ª–æ–º", "—Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç", "—Å–≤–∏–¥–µ—Ç–µ–ª—å—Å—Ç–≤–æ", "–∞—Ç—Ç–µ—Å—Ç–∞—Ç",
            "–Ω–∞—Å—Ç–∞–≤–Ω–∏–∫", "–∫—É—Ä–∞—Ç–æ—Ä", "—ç–∫—Å–ø–µ—Ä—Ç", "—Ç—Ä–µ–Ω–µ—Ä", "–∫–æ—É—á",
            "–¥–æ–º–∞—à–Ω–µ–µ –∑–∞–¥–∞–Ω–∏–µ", "–æ–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å", "–ø—Ä–æ–≤–µ—Ä–∫–∞"
        ],
        "weight": 3
    },
    # –§—Ä–∏–ª–∞–Ω—Å –∏ —Ä–∞–±–æ—Ç–∞
    "freelance": {
        "words": [
            "–∑–∞—Ä–∞–±–æ—Ç–æ–∫", "–¥–æ—Ö–æ–¥", "–ø—Ä–∏–±—ã–ª—å", "–ø–∞—Å—Å–∏–≤–Ω—ã–π –¥–æ—Ö–æ–¥",
            "—É–¥–∞–ª–µ–Ω–Ω–∞—è —Ä–∞–±–æ—Ç–∞", "—Ä–∞–±–æ—Ç–∞ –∏–∑ –¥–æ–º–∞", "—Ñ—Ä–∏–ª–∞–Ω—Å",
            "–∑–∞–∫–∞–∑—á–∏–∫", "–∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å", "–±–∏—Ä–∂–∞", "–ø–ª–æ—â–∞–¥–∫–∞",
            "–≤–∞–∫–∞–Ω—Å–∏—è", "—Ä–µ–∑—é–º–µ", "—Å–æ–±–µ—Å–µ–¥–æ–≤–∞–Ω–∏–µ", "–∏—Å–ø—ã—Ç–∞—Ç–µ–ª—å–Ω—ã–π —Å—Ä–æ–∫"
        ],
        "weight": 3
    },
    # –ö—Ä–∞—Å–æ—Ç–∞ –∏ –∑–¥–æ—Ä–æ–≤—å–µ
    "beauty_health": {
        "words": [
            "—É—Ö–æ–¥", "–∫–æ—Å–º–µ—Ç–∏–∫–∞", "—Å—Ä–µ–¥—Å—Ç–≤–æ", "–ø—Ä–µ–ø–∞—Ä–∞—Ç", "–¥–æ–±–∞–≤–∫–∞",
            "—Ä–µ–∑—É–ª—å—Ç–∞—Ç", "—ç—Ñ—Ñ–µ–∫—Ç", "–∏–∑–º–µ–Ω–µ–Ω–∏–µ", "–ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ",
            "–ø—Ä–æ—Ü–µ–¥—É—Ä–∞", "—Å–µ–∞–Ω—Å", "—Ç–µ—Ä–∞–ø–∏—è", "–ª–µ—á–µ–Ω–∏–µ", "–≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ",
            "—Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è", "–Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ", "–ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ", "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ"
        ],
        "weight": 3
    },
    # –ù–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç—å
    "real_estate": {
        "words": [
            "–∫–≤–∞—Ä—Ç–∏—Ä–∞", "–¥–æ–º", "—É—á–∞—Å—Ç–æ–∫", "–∫–æ–º–º–µ—Ä—á–µ—Å–∫–∞—è –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç—å",
            "–∏–ø–æ—Ç–µ–∫–∞", "—Ä–∞—Å—Å—Ä–æ—á–∫–∞", "–ø–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω—ã–π –≤–∑–Ω–æ—Å",
            "–ø—Ä–æ—Å–º–æ—Ç—Ä", "–ø–æ–∫–∞–∑", "–æ—Å–º–æ—Ç—Ä", "–ø–ª–∞–Ω–∏—Ä–æ–≤–∫–∞", "—Ä–µ–º–æ–Ω—Ç",
            "–∞–≥–µ–Ω—Ç", "—Ä–∏–µ–ª—Ç–æ—Ä", "–∑–∞—Å—Ç—Ä–æ–π—â–∏–∫", "—É–ø—Ä–∞–≤–ª—è—é—â–∞—è –∫–æ–º–ø–∞–Ω–∏—è"
        ],
        "weight": 3
    },
    # –ö—Ä–∏–ø—Ç–æ –∏ NFT
    "crypto": {
        "words": [
            "–∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç–∞", "–±–∏—Ç–∫–æ–∏–Ω", "—Ç–æ–∫–µ–Ω", "–±–ª–æ–∫—á–µ–π–Ω",
            "nft", "–∫–æ–ª–ª–µ–∫—Ü–∏—è", "–º–µ—Ç–∞–≤—Å–µ–ª–µ–Ω–Ω–∞—è", "web3",
            "–º–∞–π–Ω–∏–Ω–≥", "—Å—Ç–µ–π–∫–∏–Ω–≥", "—Ñ–µ—Ä–º–∞", "–ø—É–ª",
            "–∫–æ—à–µ–ª–µ–∫", "–±–∏—Ä–∂–∞", "–æ–±–º–µ–Ω–Ω–∏–∫", "—Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è"
        ],
        "weight": 5
    },
    # AI –∏ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è
    "ai_automation": {
        "words": [
            "–Ω–µ–π—Ä–æ—Å–µ—Ç—å", "–∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω—ã–π –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç", "chatgpt",
            "–±–æ—Ç", "–∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è", "—Å–∫—Ä–∏–ø—Ç", "–ø–∞—Ä—Å–µ—Ä",
            "–≥–µ–Ω–µ—Ä–∞—Ü–∏—è", "—Å–æ–∑–¥–∞–Ω–∏–µ", "–æ–±—Ä–∞–±–æ—Ç–∫–∞", "–∞–Ω–∞–ª–∏–∑",
            "api", "–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è", "–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ", "–Ω–∞—Å—Ç—Ä–æ–π–∫–∞"
        ],
        "weight": 3
    },
    # –°–æ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–µ—Ç–∏ –Ω–æ–≤–æ–≥–æ –ø–æ–∫–æ–ª–µ–Ω–∏—è
    "social_media": {
        "words": [
            "reels", "shorts", "tiktok", "likee",
            "twitch", "—Å—Ç—Ä–∏–º", "—Ç—Ä–∞–Ω—Å–ª—è—Ü–∏—è", "—ç—Ñ–∏—Ä",
            "telegram-–∫–∞–Ω–∞–ª", "discord-—Å–µ—Ä–≤–µ—Ä", "—á–∞—Ç",
            "—Ä–∞—Å—Å—ã–ª–∫–∞", "–¥–∞–π–¥–∂–µ—Å—Ç", "–Ω–æ–≤–æ—Å—Ç–Ω–∞—è —Ä–∞—Å—Å—ã–ª–∫–∞"
        ],
        "weight": 3
    },
    # –†–µ–≥–∏–æ–Ω–∞–ª—å–Ω—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏
    "regional": {
        "words": [
            "—Ä–æ—Å—Å–∏–π—Å–∫–∏–π", "–¥–ª—è —Ä–æ—Å—Å–∏–∏", "–ø–æ —Ä—Ñ", "—Å–Ω–≥",
            "–¥–æ—Å—Ç–∞–≤–∫–∞ –ø–æ –º–æ—Å–∫–≤–µ", "—Å–ø–±", "—Ä–µ–≥–∏–æ–Ω—ã",
            "–Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ", "—Ä—É—Å—Å–∫–∞—è –≤–µ—Ä—Å–∏—è",
            "–æ—Ç–µ—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–π", "–º–µ—Å—Ç–Ω—ã–π", "–ª–æ–∫–∞–ª—å–Ω—ã–π",
            "–≤ –≤–∞—à–µ–º –≥–æ—Ä–æ–¥–µ", "—Ä—è–¥–æ–º —Å –≤–∞–º–∏", "–≤ —Ä–∞–π–æ–Ω–µ",
            "–º–µ—Å—Ç–Ω—ã–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å", "–ª–æ–∫–∞–ª—å–Ω—ã–π –±—Ä–µ–Ω–¥",
            "–≥–æ—Ä–æ–¥—Å–∫–∞—è –¥–æ—Å—Ç–∞–≤–∫–∞", "—Å–∞–º–æ–≤—ã–≤–æ–∑ –∏–∑ —Ç–æ—á–∫–∏",
            "–¥–ª—è –∂–∏—Ç–µ–ª–µ–π"
        ],
        "weight": 2
    },
    # –≠–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Ç—Ä–∏–≥–≥–µ—Ä—ã - —Å—Ç—Ä–∞—Ö–∏ –∏ –±–æ–ª–∏
    "emotional_fear": {
        "words": [
            "–∏–∑–±–∞–≤–∏—Ç—å—Å—è –æ—Ç", "—Ä–µ—à–∏—Ç—å –ø—Ä–æ–±–ª–µ–º—É", "–∏–∑–±–µ–∂–∞—Ç—å –æ—à–∏–±–æ–∫",
            "–Ω–µ —Ç–µ—Ä—è–π –≤—Ä–µ–º—è", "–Ω–µ —É–ø—É—Å—Ç–∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å",
            "–±–æ–ª—å—à–µ –Ω–µ –Ω—É–∂–Ω–æ", "–±–æ–ª—å—à–µ –Ω–µ –ø—Ä–∏–¥–µ—Ç—Å—è",
            "–∑–∞–±—É–¥—å—Ç–µ –æ", "–ø–æ–∫–æ–Ω—á–∏—Ç–µ —Å", "–∏–∑–±–∞–≤—å—Ç–µ—Å—å –æ—Ç"
        ],
        "weight": 3
    },
    # –≠–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Ç—Ä–∏–≥–≥–µ—Ä—ã - –∂–µ–ª–∞–Ω–∏—è –∏ –º–µ—á—Ç—ã
    "emotional_desire": {
        "words": [
            "–º–µ—á—Ç–∞ —Å–±—ã–≤–∞–µ—Ç—Å—è", "–∂–µ–ª–∞–Ω–∏–µ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è —Ä–µ–∞–ª—å–Ω–æ—Å—Ç—å—é",
            "–Ω–∞–∫–æ–Ω–µ—Ü-—Ç–æ –º–æ–∂–Ω–æ", "—Ç–µ–ø–µ—Ä—å –¥–æ—Å—Ç—É–ø–Ω–æ",
            "–æ —á–µ–º –≤—ã –¥–∞–≤–Ω–æ –º–µ—á—Ç–∞–ª–∏", "—á—Ç–æ –≤—ã –∏—Å–∫–∞–ª–∏",
            "–≤–∞—à–∞ —Ü–µ–ª—å", "–≤–∞—à–∞ –º–µ—á—Ç–∞", "–≤–∞—à–µ –∂–µ–ª–∞–Ω–∏–µ"
        ],
        "weight": 3
    }
}

# –•–∞—Ä–∞–∫—Ç–µ—Ä–Ω—ã–µ —Ä–µ–∫–ª–∞–º–Ω—ã–µ —Ñ—Ä–∞–∑—ã (Regex)
AD_PATTERNS = [
    # –ë–∞–∑–æ–≤—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã
    r"–º–µ—Å—Ç(?:–∞)? –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–æ",
    r"–≤—Ö–æ–¥ —Ç–æ–ª—å–∫–æ –¥–ª—è",
    r"—á–∏—Ç–∞—Ç—å (?:–ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ|–¥–∞–ª–µ–µ)",
    r"—É—Å–ø–µ–π (?:–∑–∞–±—Ä–∞—Ç—å|–≤—Å—Ç—É–ø–∏—Ç—å|–∫—É–ø–∏—Ç—å)",
    r"–∑–∞–≥–ª—è–Ω–∏ –≤ –∑–∞–∫—Ä–µ–ø",
    r"–Ω–∞ –ø—Ä–∞–≤–∞—Ö —Ä–µ–∫–ª–∞–º—ã",
    r"–≤—ã–ª–æ–∂–∏–ª –≤ –∑–∞–∫—Ä—ã—Ç—ã–π",
    r"—Ü–µ–Ω–∞ —Å–Ω–∏–∂–µ–Ω–∞",
    # –†–∏—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –≤–æ–ø—Ä–æ—Å—ã
    r"—Ö–æ—Ç–∏—Ç–µ\s+\w+",
    r"–º–µ—á—Ç–∞–µ—Ç–µ\s+\w+",
    r"–∑–Ω–∞–µ—Ç–µ\s+–ª–∏\s+–≤—ã",
    r"—É—Å—Ç–∞–ª–∏\s+–æ—Ç",
    r"–Ω—É–∂–Ω–æ\s+\w+",
    r"–ø–æ—Ä–∞\s+\w+",
    r"–∫–∞–∫\s+–ø–æ–ª—É—á–∏—Ç—å",
    r"–≥–¥–µ\s+–Ω–∞–π—Ç–∏",
    r"—á—Ç–æ\s+–¥–µ–ª–∞—Ç—å\s+–µ—Å–ª–∏",
    # –í–æ—Å–∫–ª–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏
    r"–Ω–µ–≤–µ—Ä–æ—è—Ç–Ω–æ!",
    r"—É–¥–∏–≤–∏—Ç–µ–ª—å–Ω–æ!",
    r"–ø–æ—Ä–∞–∑–∏—Ç–µ–ª—å–Ω–æ!",
    r"–≤–Ω–∏–º–∞–Ω–∏–µ!",
    r"–≤–∞–∂–Ω–æ!",
    r"—Å—Ä–æ—á–Ω–æ!",
    r"—Ç–æ–ª—å–∫–æ\s+—Å–µ–π—á–∞—Å!",
    r"—É—Å–ø–µ–π!",
    r"–Ω–µ\s+–ø—Ä–æ–ø—É—Å—Ç–∏!",
    r"–ø–æ—Å–ø–µ—à–∏!",
    # –≠–º—Ñ–∞—Ç–∏—á–µ—Å–∫–∏–µ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏
    r"–∏–º–µ–Ω–Ω–æ\s+—Å–µ–π—á–∞—Å",
    r"–∏–º–µ–Ω–Ω–æ\s+–¥–ª—è\s+–≤–∞—Å",
    r"–∏–º–µ–Ω–Ω–æ\s+—ç—Ç–æ—Ç",
    r"—Ç–æ–ª—å–∫–æ\s+–∑–¥–µ—Å—å",
    r"—Ç–æ–ª—å–∫–æ\s+—Ç–∞–∫",
    r"—Ç–æ–ª—å–∫–æ\s+—É\s+–Ω–∞—Å",
    r"–∞–±—Å–æ–ª—é—Ç–Ω–æ\s+–±–µ—Å–ø–ª–∞—Ç–Ω–æ",
    r"–ø–æ–ª–Ω–æ—Å—Ç—å—é\s+–≥–æ—Ç–æ–≤—ã–π",
    r"100%\s+—Ä–µ–∑—É–ª—å—Ç–∞—Ç",
    # –ß–∏—Å–ª–æ–≤—ã–µ –∞–∫—Ü–µ–Ω—Ç—ã
    r"\d+\s+—à–∞–≥(?:–∞|–æ–≤)?",
    r"\d+\s+–ø—Ä–∏–Ω—Ü–∏–ø(?:–∞|–æ–≤)?",
    r"\d+\s+–¥–Ω(?:—è|–µ–π|—å)?",
    r"\d+\s+—É—Ä–æ–∫(?:–∞|–æ–≤)?",
    r"–≤\s+\d+\s+—Ä–∞–∑(?:–∞)?",
    r"–≤\s+\d+\s+—Ä–∞–∑(?:–∞)?\s+–±—ã—Å—Ç—Ä–µ–µ",
    r"–Ω–∞\s+\d+%\s+—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–µ–µ",
    r"–ø–µ—Ä–≤(?:—ã–π|—ã–µ)\s+\d+\s+–ø–æ–∫—É–ø–∞—Ç–µ–ª(?:—å|—è–º|–µ–π)",
    # –ß–∞—Å—Ç—ã–µ –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏ (n-grams)
    r"–∫–ª–∏–∫–Ω–∏—Ç–µ\s+–ø–æ\s+—Å—Å—ã–ª–∫–µ\s+–Ω–∏–∂–µ",
    r"–æ—Å—Ç–∞–≤—å—Ç–µ\s+–∑–∞—è–≤–∫—É\s+–≤\s+—Ñ–æ—Ä–º–µ",
    r"–ø–æ–ª—É—á–∏—Ç–µ\s+–±–µ—Å–ø–ª–∞—Ç–Ω—É—é\s+–∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—é",
    r"—Å–∫–∞—á–∞–π—Ç–µ\s+–∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é\s+—Å–µ–π—á–∞—Å",
    r"–∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å\s+–∏\s+–ø–æ–ª—É—á–∏—Ç–µ\s+–±–æ–Ω—É—Å",
    r"–ø–µ—Ä–≤—ã–º\s+\d+\s+–ø–æ–∫—É–ø–∞—Ç–µ–ª—è–º\s+—Å–∫–∏–¥–∫–∞"
]

def improved_heuristic_score(text: str) -> float:
    if not text: return 0.0
    text_lower = text.lower()
    score = 0.0

    # 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–π –∫–ª—é—á–µ–π
    for category, data in KEYWORDS_WEIGHTS.items():
        for word in data["words"]:
            # –ò—Å–ø–æ–ª—å–∑—É–µ–º –ø–æ–∏—Å–∫ –ø–æ–¥—Å—Ç—Ä–æ–∫–∏ –¥–ª—è –≥–∏–±–∫–æ—Å—Ç–∏ (—Å–∫–∏–¥–∫ -> —Å–∫–∏–¥–∫–∞, —Å–∫–∏–¥–∫–∏)
            if word in text_lower:
                score += data["weight"]

    # 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ (—Ü–µ–ª—ã—Ö —Ñ—Ä–∞–∑)
    for pattern in AD_PATTERNS:
        if re.search(pattern, text_lower):
            score += 6.0  # –§—Ä–∞–∑—ã ‚Äî –æ—á–µ–Ω—å —Å–∏–ª—å–Ω—ã–π –º–∞—Ä–∫–µ—Ä

    # 3. –ê–Ω–∞–ª–∏–∑ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã —Å–æ–æ–±—â–µ–Ω–∏—è
    # –ú–Ω–æ–≥–æ –∫–Ω–æ–ø–æ–∫ –∏–ª–∏ —Å—Å—ã–ª–æ–∫
    links_count = len(re.findall(r"https?://|t\.me/", text_lower))
    score += links_count * 4.0

    # –ê–≥—Ä–µ—Å—Å–∏–≤–Ω—ã–π –∫–∞–ø—Å (–∑–∞–≥–ª–∞–≤–Ω—ã–µ –±—É–∫–≤—ã)
    upper_ratio = sum(1 for c in text if c.isupper()) / len(text) if len(text) > 0 else 0
    if upper_ratio > 0.3 and len(text) > 20:
        score += 3.0

    # –ü–ª–æ—Ç–Ω–æ—Å—Ç—å —ç–º–æ–¥–∑–∏ (—Ä–µ–∫–ª–∞–º–∞ –æ–±—ã—á–Ω–æ –ø–µ—Å—Ç—Ä–∏—Ç –∏–º–∏)
    emoji_count = len(re.findall(r'[^\w\s,.!?]', text_lower))
    if len(text) > 0 and (emoji_count / len(text)) > 0.1:
        score += 2.0

    return score

def is_ad_refined(text: str, threshold: float = 4.0) -> bool:
    """
    –ü–æ—Ä–æ–≥ 8.0 –æ–ø—Ç–∏–º–∞–ª–µ–Ω –¥–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã –Ω–µ –ª–æ–≤–∏—Ç—å –æ–±—ã—á–Ω–æ–µ '–∫—É–ø–∏–ª —Å–∫–∏–¥–∫—É'.
    """
    return improved_heuristic_score(text) >= threshold

# –ê–ª–∏–∞—Å –¥–ª—è –æ–±—Ä–∞—Ç–Ω–æ–π —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏
heuristic_spam_score = improved_heuristic_score

# –ü—Ä–∏–º–µ—Ä –ø—Ä–æ–≤–µ—Ä–∫–∏
if __name__ == "__main__":
    test_msg = "üî• –£–°–ü–ï–ô –ó–ê–ë–†–ê–¢–¨! –ú–µ—Å—Ç –æ—Å—Ç–∞–ª–æ—Å—å –º–∞–ª–æ. –ú–æ—è —Å–µ–∫—Ä–µ—Ç–Ω–∞—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è p2p –∞—Ä–±–∏—Ç—Ä–∞–∂–∞ –≤ –∑–∞–∫—Ä–µ–ø–µ: t.me/link"
    print(f"–°–∫–æ—Ä: {improved_heuristic_score(test_msg)}, –†–µ–∫–ª–∞–º–∞: {is_ad_refined(test_msg)}")